# Git 自动提交工作流 - 快速开始

## 🚀 30秒上手

### 1. 启动智能体

```bash
./ai-agent
```

### 2. 使用自动提交

在提示符下输入以下任一命令：

```
> 提交代码
> 一键提交  
> 自动提交
> 生成并提交commit
```

### 3. 等待完成

系统会自动执行：

```
📦 步骤 1/3: 暂存变更...
[Git Add] ✅ 已暂存 5 个文件的变更

💡 步骤 2/3: 生成 commit 消息...
[Commit 生成] ✅ 生成完成
[Commit 生成] 消息: feat: 实现Git自动提交工作流

✍️  步骤 3/3: 提交代码...
[Git Commit] ✅ 代码已提交 (commit: a1b2c3d)
```

### 4. 查看结果

```
🎉 Git 自动提交流程完成！

────────────────────────────────────────────────────────────
📦 步骤 1: ✅ 已暂存 5 个文件 (新增 3 个、修改 2 个)

💡 步骤 2: ✅ 生成 commit 消息
  feat: 实现Git自动提交工作流

✍️  步骤 3: ✅ 代码已提交 (commit: a1b2c3d)
────────────────────────────────────────────────────────────

💡 提示: 使用 'git log' 查看提交历史
```

## 💡 实际示例

### 示例 1: 日常开发提交

```bash
# 修改了几个文件后
> 提交代码

# 输出
✅ 已暂存 3 个文件 (修改 3 个)
✅ 已生成 commit 消息
  refactor: 优化用户认证模块性能
✅ 代码已提交 (commit: f8e9a1b)
```

### 示例 2: 新功能开发

```bash
# 新增了功能文件
> 一键提交

# 输出
✅ 已暂存 8 个文件 (新增 5 个、修改 3 个)
✅ 已生成 commit 消息
  feat: 添加用户权限管理功能，支持角色分配和权限控制
✅ 代码已提交 (commit: b3c4d5e)
```

### 示例 3: Bug 修复

```bash
# 修复了一个 bug
> 自动提交

# 输出
✅ 已暂存 2 个文件 (修改 2 个)
✅ 已生成 commit 消息
  fix: 修复登录页面输入验证错误，添加邮箱格式检查
✅ 代码已提交 (commit: 6d7e8f9)
```

### 示例 4: 文档更新

```bash
# 更新了文档
> 生成并提交commit

# 输出
✅ 已暂存 4 个文件 (修改 4 个)
✅ 已生成 commit 消息
  docs: 更新API文档，添加新接口说明和使用示例
✅ 代码已提交 (commit: a2b3c4d)
```

## 🔍 与普通 commit 的对比

### 传统方式（3步）

```bash
# 步骤 1
$ git add .

# 步骤 2（需要自己想 commit 消息）
$ git diff --cached  # 查看变更
# ... 思考消息 ...
# ... 打字 ...

# 步骤 3
$ git commit -m "更新了一些代码"  # 消息往往不够详细
```

### 自动提交（1步）

```bash
> 提交代码

# 系统自动:
# 1. git add .
# 2. 分析代码变更，生成高质量 commit 消息
# 3. git commit
```

## ❓ 常见问题

### Q1: 如果我不满意生成的消息怎么办？

可以使用 "生成commit日志" 先查看消息，满意后再手动提交：

```bash
> 生成commit日志

# 查看生成的消息
# 如果满意：
$ git commit -m "显示的消息"

# 如果不满意：
$ git commit -m "你自己的消息"
```

### Q2: 会自动 push 吗？

不会。自动提交只执行到 `git commit`，不会 push 到远程。你可以之后手动 push：

```bash
$ git push
```

### Q3: 如果提交失败了怎么办？

系统会显示详细的错误信息和手动命令：

```
❌ Git 提交流程失败

步骤 1: ✅ 已暂存 5 个文件
步骤 2: ✅ 已生成 commit 消息
步骤 3: ❌ git commit 失败: ...

你可以手动执行:
  git commit -m "生成的消息"
```

### Q4: 支持暂存部分文件吗？

目前自动提交会执行 `git add .` 暂存所有变更。如果需要部分提交：

```bash
# 手动 add 想要的文件
$ git add file1.py file2.py

# 然后使用"生成commit日志"
> 生成commit日志

# 最后手动 commit
$ git commit -m "显示的消息"
```

### Q5: 生成的 commit 消息质量如何？

系统使用 Claude 3.5 Sonnet（代码模型）基于实际的 git diff 分析：

✅ 遵循 Conventional Commits 规范  
✅ 使用准确的 type（feat/fix/refactor等）  
✅ 描述具体的变更内容  
✅ 参考你的历史 commit 风格  

示例：
```
feat: 实现Git自动提交工作流，支持三步骤流水线处理
refactor: 重构用户认证模块，分离JWT令牌生成逻辑
fix: 修复文件上传API内存泄漏，添加流式处理
docs: 更新README添加安装步骤和使用示例
```

## 🎯 最佳实践

### ✅ 推荐使用场景

1. **日常开发** - 快速提交小改动
2. **功能开发** - 完成阶段性工作后提交
3. **Bug 修复** - 修复后快速提交
4. **文档更新** - 更新文档后提交

### ⚠️ 不推荐场景

1. **大规模重构** - 建议手动写更详细的 commit body
2. **多个不相关改动** - 应该分开提交
3. **敏感内容** - 需要仔细检查 commit 消息

### 💡 提示

- 养成频繁小提交的习惯
- 每个提交只做一件事
- 提交前确保代码可运行
- 定期 push 到远程仓库

## 🔗 相关文档

- [详细实现文档](./GIT_AUTO_COMMIT_WORKFLOW.md)
- [Git Commit 功能文档](./GIT_COMMIT_FEATURE.md)
- [项目主文档](../README.md)

## 🎉 开始使用

现在就试试吧！

```bash
./ai-agent
> 提交代码
```

享受自动化的快乐！ 🚀

