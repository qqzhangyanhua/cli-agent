---
description: @ æ–‡ä»¶å¼•ç”¨åŠŸèƒ½å¼€å‘æŒ‡å—
---

# @ æ–‡ä»¶å¼•ç”¨åŠŸèƒ½æŒ‡å—

è¿™æ˜¯é¡¹ç›®çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ @ è¯­æ³•å¿«é€Ÿå¼•ç”¨æ–‡ä»¶ã€‚

## æ ¸å¿ƒæ¨¡å—
- [file_reference_parser.py](mdc:file_reference_parser.py) - @ è¯­æ³•è§£æå’Œæ–‡ä»¶å†…å®¹è¯»å–
- [interactive_file_selector.py](mdc:interactive_file_selector.py) - äº¤äº’å¼æ–‡ä»¶é€‰æ‹©å™¨
- [ai-agent](mdc:ai-agent) ä¸­çš„ `smart_input_handler()` - æ™ºèƒ½è¾“å…¥å¤„ç†

## å·¥ä½œæµç¨‹

### 1. ç”¨æˆ·è¾“å…¥ @ 
```python
# åœ¨ smart_input_handler() ä¸­å¤„ç†
if user_input == "@":
    # å¯åŠ¨äº¤äº’å¼æ–‡ä»¶é€‰æ‹©å™¨
    selected_file = interactive_file_select("é€‰æ‹©è¦å¼•ç”¨çš„æ–‡ä»¶")
```

### 2. å¿«é€Ÿæœç´¢æ¨¡å¼
```python
# ç”¨æˆ·è¾“å…¥ @readme
if user_input.startswith("@") and len(user_input) > 1:
    search_term = user_input[1:].split()[0]
    selected_file = quick_file_select(search_term)
```

### 3. ç›´æ¥å¼•ç”¨æ¨¡å¼
```python
# ç”¨æˆ·è¾“å…¥ "è¯»å– @README.md"
# åœ¨ file_reference_resolver() èŠ‚ç‚¹ä¸­è§£æ
referenced_files = extract_file_references(user_input)
for file in referenced_files:
    content = read_file_content(file)
    state["file_contents"][file] = content
```

## æ”¯æŒçš„è¯­æ³•

### æ–‡ä»¶ååŒ¹é…
- `@readme` - æ¨¡ç³ŠåŒ¹é… README.md
- `@config` - åŒ¹é… agent_config.py

### è·¯å¾„å¼•ç”¨
- `@./path/file.py` - ç›¸å¯¹è·¯å¾„
- `@/absolute/path` - ç»å¯¹è·¯å¾„

### é€šé…ç¬¦
- `@*.py` - åŒ¹é…æ‰€æœ‰ Python æ–‡ä»¶
- `@test_*.py` - åŒ¹é…æµ‹è¯•æ–‡ä»¶

### å¤šæ–‡ä»¶å¼•ç”¨
- `æ¯”è¾ƒ @old.txt å’Œ @new.txt` - åŒæ—¶å¼•ç”¨å¤šä¸ªæ–‡ä»¶

## äº¤äº’å¼é€‰æ‹©å™¨åŠŸèƒ½

### æ–‡ä»¶åˆ—è¡¨æ˜¾ç¤º
```python
class InteractiveFileSelector:
    def get_files_list(self) -> List[dict]:
        """è·å–æ–‡ä»¶åˆ—è¡¨ï¼ŒåŒ…å«å›¾æ ‡ã€å¤§å°ç­‰ä¿¡æ¯"""
    
    def display_files_page(self, files, page):
        """åˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨"""
```

### å¿«æ·æ“ä½œ
- `n` - ä¸‹ä¸€é¡µ
- `p` - ä¸Šä¸€é¡µ
- `h` - æ˜¾ç¤º/éšè—éšè—æ–‡ä»¶
- `r` - åˆ·æ–°åˆ—è¡¨
- `q` - é€€å‡ºé€‰æ‹©

### æœç´¢å’Œè¿‡æ»¤
```python
def filter_files(self, files: List[dict], filter_text: str):
    """å®æ—¶æœç´¢å’Œè¿‡æ»¤æ–‡ä»¶"""
    # ç²¾ç¡®åŒ¹é… > å¼€å¤´åŒ¹é… > åŒ…å«åŒ¹é…
```

## æ–‡ä»¶å†…å®¹æ³¨å…¥

### åœ¨å·¥ä½œæµä¸­å¤„ç†
```python
def file_reference_resolver(state: AgentState) -> AgentState:
    """è§£æ @ å¼•ç”¨å¹¶è¯»å–æ–‡ä»¶å†…å®¹"""
    user_input = state["user_input"]
    
    # æå–æ‰€æœ‰ @ å¼•ç”¨
    files = extract_file_references(user_input)
    
    # è¯»å–æ–‡ä»¶å†…å®¹
    for file in files:
        content = read_file_content(file)
        state["file_contents"][file] = content
        state["referenced_files"].append(file)
    
    return state
```

### å†…å®¹æ³¨å…¥åˆ°æç¤ºè¯
```python
# åœ¨ç”Ÿæˆæç¤ºè¯æ—¶æ³¨å…¥æ–‡ä»¶å†…å®¹
if state["file_contents"]:
    context = "\n\nå·²å¼•ç”¨çš„æ–‡ä»¶å†…å®¹ï¼š\n"
    for file, content in state["file_contents"].items():
        context += f"\n--- {file} ---\n{content}\n"
    prompt = base_prompt + context
```

## æ–‡ä»¶å›¾æ ‡æ˜ å°„
```python
icon_map = {
    '.py': 'ğŸ',
    '.js': 'ğŸŸ¨',
    '.md': 'ğŸ“',
    '.json': 'ğŸ“‹',
    '.txt': 'ğŸ“„',
    # ç›®å½•ä½¿ç”¨ ğŸ“
}
```

## é”™è¯¯å¤„ç†
- æ–‡ä»¶ä¸å­˜åœ¨ â†’ æä¾›ç›¸ä¼¼æ–‡ä»¶å»ºè®®
- æƒé™é”™è¯¯ â†’ å‹å¥½çš„é”™è¯¯æç¤º
- ç©ºæ–‡ä»¶ â†’ æç¤ºæ–‡ä»¶ä¸ºç©º
- äºŒè¿›åˆ¶æ–‡ä»¶ â†’ è­¦å‘Šå¹¶è·³è¿‡

## æ‰©å±•å»ºè®®
- æ”¯æŒæ–‡ä»¶ç¼–è¾‘ï¼š`ç¼–è¾‘ @config.py æ·»åŠ æ–°é…ç½®`
- æ”¯æŒç›®å½•æ“ä½œï¼š`åˆ—å‡º @src/ ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶`
- æ”¯æŒ Git æ“ä½œï¼š`å¯¹æ¯” @file çš„æ”¹åŠ¨`
